<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <link rel="stylesheet" href="styles/index.css" />

    <title>calendar</title>
  </head>
  <body>
    <div class="main">
      <div class="class-number">
        MS 1-1
      </div>
      <div class="home-button">
        <a href="login.html">
          <img src="./pictures/home button black.png">
        </a>
      </div>



      <div class="class-number">

      </div>

      <div class="content-wrap">
        <div class="content-right">
          <table id="calendar" align="center">
            <thead>
              <tr class="btn-wrap clearfix">
                <td>
                  <label class="prev_" id="prev"> &#60; </label>
                </td>
                <td align="center" id="current-year-month" colspan="5" value=""></td>
                <td>
                  <label class="next_" id="next"> &#62; </label>
                </td>
              </tr>
              <tr>
                <td class="sun" align="center">Sun</td>
                <td align="center">Mon</td>
                <td align="center">Tue</td>
                <td align="center">Wed</td>
                <td align="center">Thu</td>
                <td align="center">Fri</td>
                <td class="sat" align="center">Sat</td>
              </tr>
            </thead>
            <tbody id="calendar-body" class="calendar-body"></tbody>
            
          </table>
        </div>
      </div>
      <div class="content-left">
        <div class="main-wrap">
          <div id="main-day" class="main-day"></div>
          <div id="main-date" class="main-date" value=""></div>
          <div id="main-week" class="main-week"></div>
        </div>
        <div class="todo-wrap">
          <div class="todo-title">
            <p id="todo-list">
            </p>
          </div>
          <article></article>
          
      </div>
    </div>
    <button class='buttons' id='submitBtn' type="submit" onclick="fetchPage()">SUBMIT</button>
  </body>
  <script src="./ms11.js"></script>
  <script type="text/javascript">
    async function fetchPage(){
      //var submitValue = document.getElementById("Current-year-month").value+"-"+document.getElementById("main-date");
      var submitValue = "high_2_1,2022-08-29";

      await fetch("../inputpage/mysql_output.php", {
        method:"post",
        headers:{"Content-Type":"application/json; charset=UTF-8"},
        body:JSON.stringify(submitValue)
      });

      var text = await fetch("../inputpage/convert_json").then(res => res.text().then(res => {
        res = JSON.parse(res);

        for(var i = 0 ; i < res.length ; i++)
        {
          res[i] = JSON.parse(res[i]);
        }

        return res;
      }));

      let value = "<table border=\"1\"><th>제목</th><th>내용</th><th>과목</th><th>날짜</th><th>교시</th>";
      for(var i = 0 ; i < text.length ; i++)
      {
        value += "<tr>"
        for(var j in text[i])
        {
          value += "<td>"+text[i][j]+"</td>";
        }
        value += "</tr>";
      }
      value += "</table>";

      console.log(value);

      document.getElementById("todo-list").innerHTML = value;
    }
  </script>
</html>